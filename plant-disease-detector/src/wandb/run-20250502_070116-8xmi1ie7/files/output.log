
Training CNN with MI Regularization + Attention...
Using device: mps
/Users/preddy/PyCharmMiscProject/.venv2/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1/10: 100%|██████████| 1188/1188 [04:50<00:00,  4.09it/s, loss=0.139, mi_lambda=0.002] 
Saved best model with val_acc: 92.46%
Epoch [1/10] Train Loss: 0.4076 Train Acc: 87.68% Val Loss: 0.2344 Val Acc: 92.46% MI Lambda: 0.0020
Epoch 2/10: 100%|██████████| 1188/1188 [04:55<00:00,  4.02it/s, loss=0.0143, mi_lambda=0.004]
Saved best model with val_acc: 94.69%
Epoch [2/10] Train Loss: 0.1716 Train Acc: 94.21% Val Loss: 0.1836 Val Acc: 94.69% MI Lambda: 0.0040
Epoch 3/10: 100%|██████████| 1188/1188 [04:57<00:00,  3.99it/s, loss=0.12, mi_lambda=0.006]   
Saved best model with val_acc: 97.70%
Epoch [3/10] Train Loss: 0.1305 Train Acc: 95.47% Val Loss: 0.0702 Val Acc: 97.70% MI Lambda: 0.0060
Epoch 4/10: 100%|██████████| 1188/1188 [04:56<00:00,  4.01it/s, loss=0.00176, mi_lambda=0.008]
Epoch [4/10] Train Loss: 0.1012 Train Acc: 96.32% Val Loss: 0.0939 Val Acc: 97.04% MI Lambda: 0.0080
Epoch 5/10: 100%|██████████| 1188/1188 [04:54<00:00,  4.04it/s, loss=0.196, mi_lambda=0.01]   
Epoch [5/10] Train Loss: 0.0783 Train Acc: 96.76% Val Loss: 0.0832 Val Acc: 97.39% MI Lambda: 0.0100
Epoch 6/10: 100%|██████████| 1188/1188 [28:09<00:00,  1.42s/it, loss=0.0683, mi_lambda=0.05]    
Saved best model with val_acc: 98.11%
Epoch [6/10] Train Loss: -0.0097 Train Acc: 97.13% Val Loss: 0.0607 Val Acc: 98.11% MI Lambda: 0.0500
Epoch 7/10: 100%|██████████| 1188/1188 [06:51<00:00,  2.88it/s, loss=0.345, mi_lambda=0.05]  
Saved best model with val_acc: 98.74%
Epoch [7/10] Train Loss: -0.0417 Train Acc: 97.58% Val Loss: 0.0448 Val Acc: 98.74% MI Lambda: 0.0500
Epoch 8/10: 100%|██████████| 1188/1188 [06:41<00:00,  2.96it/s, loss=0.0193, mi_lambda=0.05] 
Epoch [8/10] Train Loss: -0.0548 Train Acc: 97.73% Val Loss: 0.0685 Val Acc: 97.86% MI Lambda: 0.0500
Epoch 9/10: 100%|██████████| 1188/1188 [06:37<00:00,  2.99it/s, loss=0.122, mi_lambda=0.05]   
Saved best model with val_acc: 98.87%
Epoch [9/10] Train Loss: -0.0649 Train Acc: 97.97% Val Loss: 0.0363 Val Acc: 98.87% MI Lambda: 0.0500
Epoch 10/10: 100%|██████████| 1188/1188 [06:36<00:00,  2.99it/s, loss=0.741, mi_lambda=0.05]   
Saved best model with val_acc: 98.91%
Epoch [10/10] Train Loss: -0.0700 Train Acc: 98.01% Val Loss: 0.0366 Val Acc: 98.91% MI Lambda: 0.0500
Attentive CNN model trained with MI regularization and saved!
Best validation accuracy: 98.91%
